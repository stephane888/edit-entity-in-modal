"use strict";(("undefined"!==typeof self?self:this)["webpackChunkEditEntity"]=("undefined"!==typeof self?self:this)["webpackChunkEditEntity"]||[]).push([[371],{8371:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var i=function(){var e=this,t=e._self._c;return t("div",[t("modalForm",{attrs:{"title-modal":e.titleModal,"manage-modal":e.manageModal},on:{closeModal:e.closeModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("HCardIcon",{attrs:{"with-mb":!1},scopedSlots:e._u([{key:"titre",fn:function(){return[t("span",[e._v(" Modifier le contenu ")])]},proxy:!0},{key:"default",fn:function(){return[t("span",[e._v(" Veillez remplir les champs ci-dessous et enregistrer ")]),t("br"),t("span",[e._v(" En cas de probleme ou d'incomprehension , veillez nous "),t("a",{attrs:{href:"#"}},[e._v(" laisser un message ")])])]},proxy:!0}])})]},proxy:!0}])})],1)},s=[],a=function(){var e=this,t=e._self._c;return t("b-modal",{attrs:{id:"b-modal-manage-project",title:"BootstrapVue",size:"lg","footer-bg-variant":"light","header-bg-variant":"light","body-class":"edit-entity-in-modal","hide-footer":!1,"no-close-on-backdrop":!1},on:{ok:e.handleOk},scopedSlots:e._u([{key:"modal-header",fn:function(){return[e._t("header")]},proxy:!0},{key:"default",fn:function(){return[t("b-alert",{attrs:{variant:"danger",fade:"",show:e.hasErrorOnprocess}},[t("error-message")],1),t("formEdit",{ref:"formEdit"})]},proxy:!0},{key:"modal-footer",fn:function({cancel:n}){return[e.run_entity.numbers?t("div",{staticClass:"run-entity"},[t("b-alert",{attrs:{variant:e.hasErrorOnprocess?"danger":"info",fade:"",show:!0}},[t("strong",[e._v(" "+e._s(e.run_entity.creates))]),e._v(" / "+e._s(e.run_entity.numbers)+" Contenus mise à jour. "),e.hasErrorOnprocess?t("div",[t("error-message")],1):e._e()])],1):e._e(),t("b-button",{class:e.waiting?"save-wait":"",attrs:{disabled:e.waiting,size:"md",variant:"info"},on:{click:e.handleOk}},[t("b-icon",{attrs:{icon:"save2",variant:"white"}}),t("span",[e._v(" Enregister ")]),e.waiting?t("svgWaiting"):e._e()],1),t("b-button",{attrs:{disabled:e.waiting,size:"md",variant:"outline-secondary"},on:{click:function(e){return n()}}},[e._v(" Annuler ")])]}}],null,!0),model:{value:e.openModel,callback:function(t){e.openModel=t},expression:"openModel"}})},o=[],r=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("b-alert",{staticClass:"building-fields d-flex align-items-center",attrs:{variant:"info",fade:"",show:e.building_fields}},[t("h3",{staticClass:"d-flex align-items-center mb-0 ml-0 mr-auto"},[e._v(" Construction du formulaire encours ")]),t("b-icon",{staticClass:"ml-5",attrs:{icon:"three-dots",animation:"cylon","font-scale":"4"}})],1),t("b-alert",{staticClass:"building-fields d-flex align-items-center",attrs:{variant:"primary",fade:"",show:e.running}},[t("h3",{staticClass:"d-flex align-items-center mb-0 ml-0 mr-auto"},[e._v(" Encours d'execution ")]),t("b-icon",{staticClass:"ml-5",attrs:{icon:"three-dots",animation:"cylon","font-scale":"4"}})],1)],1),e.show?t("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit.apply(null,arguments)},reset:e.onReset}},e._l(e.fields,(function(n,i){return t(n.template,{key:i,tag:"component",attrs:{entity:n.entity,"class-entity":["pt-1"]}},e._l(n.fields,(function(n,s){return t(n.template,{key:s,tag:"component",attrs:{field:n.field,model:n.model,entities:n.entities,"class-css":["mb-5"],"parent-name":i+".entity.","parent-child-name":i+".entities.","namespace-store":""},on:{addNewValue:function(t){return e.addNewValue(t,n)},removeField:function(t){return e.removeField(t,n)},array_move:function(t){return e.array_move(t,n)}}})})),1)})),1):e._e()],1)},l=[],d=(n(7658),n(6389)),u=n(8822),c={name:"FormuLaire",props:{showSubmit:{type:Boolean,default:!1}},data(){return{show:!0}},computed:{...(0,u.rn)({fields:e=>e.fields,building_fields:e=>e.building_fields,running:e=>e.running}),idEntity(){if(""!==this.form.label){var e=d.Z.generateIdEntityType(this.form.label);return this.setId(e),e}return""}},methods:{onSubmit(){this.submit()},submit(){return this.$store.dispatch("saveEntities")},onReset(e){e.preventDefault(),this.show=!1,this.$nextTick((()=>{this.show=!0}))},setId(e){this.form.uuid||(this.form.id=e)},addNewValue(e,t){this.model[t.field.name].push(e)},removeField(e,t){this.model[t.field.name].splice(e,1)},array_move(e,t){const n=(e,t,n)=>{let i=e.splice(t,1);return e.splice(n,0,i[0]),e},i=n(this.model[t.field.name],e.oldIndex,e.newIndex);this.$store.dispatch("setValue",{value:i,fieldName:t.field.name})}}},m=c,h=n(1001),f=(0,h.Z)(m,r,l,!1,null,null,null),p=f.exports,g={components:{formEdit:p,svgWaiting:()=>n.e(154).then(n.bind(n,5154)),"error-message":{props:[],template:"<div> Une <strong> erreur s'est produite </strong> , nos administrateurs sont  deja notifiées, ils vous contacterons des que c'est corrigé.<br /> Nous nous excusons pour ce désagrément ... </div>",mounted(){}}},props:{manageModal:{type:Boolean,default:!1}},data(){return{waiting:!1,hasErrorOnprocess:!1}},computed:{...(0,u.rn)({run_entity:e=>e.run_entity}),openModel:{get(){return!!this.manageModal},set(e){this.$emit("closeModal",e)}}},methods:{handleOk(e){e.preventDefault(),this.waiting||(this.waiting=!0,this.hasErrorOnprocess=!1,this.$refs.formEdit.submit().then((()=>{this.waiting=!1,this.$bvModal.hide("b-modal-manage-project"),window.location.assign(window.location.pathname)})).catch((e=>{console.log("error : ",e),this.waiting=!1,this.hasErrorOnprocess=!0})))}}},y=g,_=(0,h.Z)(y,a,o,!1,null,null,null),v=_.exports,b={name:"EditEntity",components:{modalForm:v},data(){return{titleModal:"",manageModal:!1}},computed:{...(0,u.rn)({currentEntityInfo:e=>e.currentEntityInfo})},mounted(){this.check_edit_entity()},methods:{check_edit_entity(){document.addEventListener("formatage_models_data_quick_edit_vuejs",(e=>{e.detail&&e.detail.id&&(this.currentEntityInfo.id&&e.detail.id!=this.currentEntityInfo.id?(console.log(" check_edit_entity Nettoyage "),this.$store.dispatch("cleanDatas").then((()=>{this.initEdit(e)}))):(console.log(" check_edit_entity faux "),this.initEdit(e)))}),!1)},initEdit(e){console.log("initEdit : ",e.detail),this.openModal(),this.$store.dispatch("set_currentEntityForm",e.detail).then((()=>{this.$store.dispatch("loadForm")}))},openModal(){this.manageModal?this.manageModal=!1:this.manageModal=!0},closeModal(){this.manageModal=!1}}},E=b,w=(0,h.Z)(E,i,s,!1,null,null,null),k=w.exports}}]);
//# sourceMappingURL=EditEntity.umd.min.371.js.map